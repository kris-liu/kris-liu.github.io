<!DOCTYPE html><html lang="zh-CN"><head><meta name="google-site-verification" content="DVfrDhwMEodDoWVy6nv0PCpolWhBlGBSaO9hiU2r61E"><meta name="google-site-verification" content="40TgWkMJTOetJQqAMZwk5nD5rtVQRjk5i2pe6FGka5g"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="佑祺's Blog"><title>Netty源码分析 解决NIO的epoll死循环bug | 佑祺's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-91282031-1','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Netty源码分析 解决NIO的epoll死循环bug</h1><a id="logo" href="/.">佑祺's Blog</a><p class="description">Whatever you do, you have to keep moving forward!</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Netty源码分析 解决NIO的epoll死循环bug</h1><div class="post-meta">Mar 20, 2017<span> | </span><span class="category"><a href="/categories/Netty/">Netty</a></span></div><div class="post-content"><blockquote>
<p>本文使用<code>netty-4.1.5.Final</code>版本源码进行分析</p>
</blockquote>
<p>JDK的NIO类库有一个epoll死循环bug，它会导致Selector空轮询，IO线程CPU达到100%，严重影响系统运行。netty从api使用层面对该bug进行了规避解决，下面看下netty的解决策略并从源码了解其具体实现。</p>
<a id="more"></a>
<h3 id="Netty的解决策略："><a href="#Netty的解决策略：" class="headerlink" title="Netty的解决策略："></a>Netty的解决策略：</h3><ol>
<li>对Selector的select操作周期进行统计。</li>
<li>每完成一次空的select操作进行一次计数。</li>
<li>在某个周期内如果连续N次空轮询，则说明触发了JDK NIO的epoll死循环bug。</li>
<li>创建新的Selector，将出现bug的Selector上的channel重新注册到新的Selector上。</li>
<li>关闭bug的Selector，使用新的Selector进行替换。</li>
</ol>
<h3 id="源码解析："><a href="#源码解析：" class="headerlink" title="源码解析："></a>源码解析：</h3><p>netty中的select操作，如果有被选择出来的channel，或者有task任务，或者有定时任务task，或者需要wakenUp，或者超时，将会退出当前select操作。该逻辑识别并规避解决了epoll死循环bug：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">(<span class="keyword">boolean</span> oldWakenUp)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    Selector selector = <span class="keyword">this</span>.selector;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">int</span> selectCnt = <span class="number">0</span>;</div><div class="line">        <span class="keyword">long</span> currentTimeNanos = System.nanoTime();<span class="comment">//当前时间</span></div><div class="line">        <span class="keyword">long</span> selectDeadLineNanos = currentTimeNanos + delayNanos(currentTimeNanos);<span class="comment">//当前时间+下一个定时task的延迟时间得到当前select操作的最晚时间点，如果没有定时task则取默认1秒</span></div><div class="line">        <span class="keyword">for</span> (;;) &#123;</div><div class="line">            <span class="keyword">long</span> timeoutMillis = (selectDeadLineNanos - currentTimeNanos + <span class="number">500000L</span>) / <span class="number">1000000L</span>;<span class="comment">//转换成毫秒并增加0.5毫秒调整值处理精度损失</span></div><div class="line">            <span class="keyword">if</span> (timeoutMillis &lt;= <span class="number">0</span>) &#123;<span class="comment">//到达超时时间则退出</span></div><div class="line">                <span class="keyword">if</span> (selectCnt == <span class="number">0</span>) &#123;<span class="comment">//如果是第一次则需要执行一次selectNow操作再退出</span></div><div class="line">                    selector.selectNow();</div><div class="line">                    selectCnt = <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="comment">// If a task was submitted when wakenUp value was true, the task didn't get a chance to call</span></div><div class="line">            <span class="comment">// Selector#wakeup. So we need to check task queue again before executing select operation.</span></div><div class="line">            <span class="comment">// If we don't, the task might be pended until select operation was timed out.</span></div><div class="line">            <span class="comment">// It might be pended until idle timeout if IdleStateHandler existed in pipeline.</span></div><div class="line">            <span class="keyword">if</span> (hasTasks() &amp;&amp; wakenUp.compareAndSet(<span class="keyword">false</span>, <span class="keyword">true</span>)) &#123;<span class="comment">//检查是否有task任务并且wakenUp可以被设置为true，则需要执行一次selectNow操作再退出</span></div><div class="line">                selector.selectNow();</div><div class="line">                selectCnt = <span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">int</span> selectedKeys = selector.select(timeoutMillis);<span class="comment">//进行一次select(timeoutMillis)操作并增加selectCnt计数</span></div><div class="line">            selectCnt ++;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (selectedKeys != <span class="number">0</span> || oldWakenUp || wakenUp.get() || hasTasks() || hasScheduledTasks()) &#123;<span class="comment">//如果有选择出来的selectedKeys，或者需要wakenUp，或者task队列有任务，或者定时task队列有任务，则可以退出</span></div><div class="line">                <span class="comment">// - Selected something,</span></div><div class="line">                <span class="comment">// - waken up by user, or</span></div><div class="line">                <span class="comment">// - the task queue has a pending task.</span></div><div class="line">                <span class="comment">// - a scheduled task is ready for processing</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (Thread.interrupted()) &#123;<span class="comment">//如果当前线程被中断则退出</span></div><div class="line">                <span class="comment">// Thread was interrupted so reset selected keys and break so we not run into a busy loop.</span></div><div class="line">                <span class="comment">// As this is most likely a bug in the handler of the user or it's client library we will</span></div><div class="line">                <span class="comment">// also log it.</span></div><div class="line">                <span class="comment">//</span></div><div class="line">                <span class="comment">// See https://github.com/netty/netty/issues/2426</span></div><div class="line">                <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</div><div class="line">                    logger.debug(<span class="string">"Selector.select() returned prematurely because "</span> +</div><div class="line">                            <span class="string">"Thread.currentThread().interrupt() was called. Use "</span> +</div><div class="line">                            <span class="string">"NioEventLoop.shutdownGracefully() to shutdown the NioEventLoop."</span>);</div><div class="line">                &#125;</div><div class="line">                selectCnt = <span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">long</span> time = System.nanoTime();</div><div class="line">            <span class="keyword">if</span> (time - TimeUnit.MILLISECONDS.toNanos(timeoutMillis) &gt;= currentTimeNanos) &#123;<span class="comment">//超时则将selectCnt置为1</span></div><div class="line">                <span class="comment">// timeoutMillis elapsed without anything selected.</span></div><div class="line">                selectCnt = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (SELECTOR_AUTO_REBUILD_THRESHOLD &gt; <span class="number">0</span> &amp;&amp;</div><div class="line">                    selectCnt &gt;= SELECTOR_AUTO_REBUILD_THRESHOLD) &#123;<span class="comment">//如果select操作周期计数值selectCnt超出io.netty.selectorAutoRebuildThreshold设置的阈值，默认512次，说明在该周期内发生了空轮询，触发了JDK NIO的epoll死循环bug。</span></div><div class="line">                <span class="comment">// The selector returned prematurely many times in a row.</span></div><div class="line">                <span class="comment">// Rebuild the selector to work around the problem.</span></div><div class="line">                logger.warn(</div><div class="line">                        <span class="string">"Selector.select() returned prematurely &#123;&#125; times in a row; rebuilding Selector &#123;&#125;."</span>,</div><div class="line">                        selectCnt, selector);</div><div class="line"></div><div class="line">                rebuildSelector();<span class="comment">//重建Selector</span></div><div class="line">                selector = <span class="keyword">this</span>.selector;</div><div class="line"></div><div class="line">                <span class="comment">// Select again to populate selectedKeys.</span></div><div class="line">                selector.selectNow();对新的selector执行一次selectNow操作然后退出选择操作</div><div class="line">                selectCnt = <span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            currentTimeNanos = time;<span class="comment">//一次for循环结束后重置currentTimeNanos</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (selectCnt &gt; MIN_PREMATURE_SELECTOR_RETURNS) &#123;</div><div class="line">            <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</div><div class="line">                logger.debug(<span class="string">"Selector.select() returned prematurely &#123;&#125; times in a row for Selector &#123;&#125;."</span>,</div><div class="line">                        selectCnt - <span class="number">1</span>, selector);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125; <span class="keyword">catch</span> (CancelledKeyException e) &#123;</div><div class="line">        <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</div><div class="line">            logger.debug(CancelledKeyException.class.getSimpleName() + <span class="string">" raised by a Selector &#123;&#125; - JDK bug?"</span>,</div><div class="line">                    selector, e);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// Harmless exception - log anyway</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>重建Selector。当发生epoll bug，则创建一个新的Selector，将出现bug的Selector上的channel重新注册到新的Selector上，关闭bug的Selector，使用新的Selector进行替换：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rebuildSelector</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (!inEventLoop()) &#123;<span class="comment">//如果是非当前EventLoop执行rebuild，则将rebuild操作封装成task，交由对应的EventLoop线程执行rebuild操作</span></div><div class="line">        execute(<span class="keyword">new</span> Runnable() &#123;</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                rebuildSelector();</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">final</span> Selector oldSelector = selector;</div><div class="line">    <span class="keyword">final</span> Selector newSelector;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (oldSelector == <span class="keyword">null</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        newSelector = openSelector();<span class="comment">//打开一个新的Selector</span></div><div class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">        logger.warn(<span class="string">"Failed to create a new Selector."</span>, e);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Register all channels to the new Selector.</span></div><div class="line">    <span class="keyword">int</span> nChannels = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (;;) &#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">for</span> (SelectionKey key: oldSelector.keys()) &#123;<span class="comment">//遍历所有老的Selector上的channel，重新注册到新的Selector上</span></div><div class="line">                Object a = key.attachment();</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    <span class="keyword">if</span> (!key.isValid() || key.channel().keyFor(newSelector) != <span class="keyword">null</span>) &#123;<span class="comment">//SelectionKey无效或者已经注册上了则跳过</span></div><div class="line">                        <span class="keyword">continue</span>;</div><div class="line">                    &#125;</div><div class="line"></div><div class="line">                    <span class="keyword">int</span> interestOps = key.interestOps();</div><div class="line">                    key.cancel();<span class="comment">//取消SelectionKey</span></div><div class="line">                    SelectionKey newKey = key.channel().register(newSelector, interestOps, a);<span class="comment">//将SelectionKey中的channel注册到新的Selector上</span></div><div class="line">                    <span class="keyword">if</span> (a <span class="keyword">instanceof</span> AbstractNioChannel) &#123;</div><div class="line">                        <span class="comment">// Update SelectionKey</span></div><div class="line">                        ((AbstractNioChannel) a).selectionKey = newKey;<span class="comment">//将AbstractNioChannel的成员变量selectionKey赋新值</span></div><div class="line">                    &#125;</div><div class="line">                    nChannels ++;</div><div class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">                    logger.warn(<span class="string">"Failed to re-register a Channel to the new Selector."</span>, e);</div><div class="line">                    <span class="keyword">if</span> (a <span class="keyword">instanceof</span> AbstractNioChannel) &#123;</div><div class="line">                        AbstractNioChannel ch = (AbstractNioChannel) a;</div><div class="line">                        ch.unsafe().close(ch.unsafe().voidPromise());</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</div><div class="line">                        NioTask&lt;SelectableChannel&gt; task = (NioTask&lt;SelectableChannel&gt;) a;</div><div class="line">                        invokeChannelUnregistered(task, key, e);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span> (ConcurrentModificationException e) &#123;</div><div class="line">            <span class="comment">// Probably due to concurrent modification of the key set.</span></div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    selector = newSelector;<span class="comment">//用新的Selector替换老的Selector</span></div><div class="line"></div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="comment">// time to close the old selector as everything else is registered to the new one</span></div><div class="line">        oldSelector.close();<span class="comment">//关闭老的Selector</span></div><div class="line">    &#125; <span class="keyword">catch</span> (Throwable t) &#123;</div><div class="line">        <span class="keyword">if</span> (logger.isWarnEnabled()) &#123;</div><div class="line">            logger.warn(<span class="string">"Failed to close the old Selector."</span>, t);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    logger.info(<span class="string">"Migrated "</span> + nChannels + <span class="string">" channel(s) to the new Selector."</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>如果发生epoll死循环bug，那么当前I/O线程将停下来进行bug的修复，然后再继续进行逻辑处理，bug的修复是非阻塞操作，处理速度非常快；而且netty线程池中一般设置有多个I/O线程，其中某个I/O线程中的Selector触发bug并不会影响其他I/O线程运行，所以netty通过这种策略，在几乎不影响性能的情况下从api使用层面规避解决了该bug。</p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://blogxin.cn/2017/03/20/Netty-epollbug/" data-id="cka174cvc0036u2r0blzyd05e" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKUlEQVR42u3aS27DMAwFwNz/0um2QBr3kXSLSBqtCsMfTRYsKfLxiNfzZb1e/37l3Ruqb7t5YWBgLMt4Xq7re3pf6cF++ToGBsYBjCREXt+fBM38J8v3hoGBgZFsPWHnYRoDAwPj3oD7+mxS4n7c/w0MDIxFGPmr8xD8obU4BgbGgox8E///95/0NzAwMJZiPIsrL1YniWB5VxgYGFszqkdp+WhFr8Tt7QcDA+M0xmTkKy84eyF7lL1iYGAsy7j+zF1p32Sj0ZEfBgbGAYxqMnfNqLYcesMZP9TiGBgYWzN6oTNvUk7SzSgEY2BgHMCYjEfkx2Q9QGFaBAMDY2tGL/zlieBdzc63u8LAwNiakR/x9xoDvQO13mAHBgbGrow87csHL/LeabW4fft+DAyMrRn5tiak/Og/aRs85lvBwMBYipEHtUljYJI+joYtMDAwtmNckyZHb5PksjwzgoGBcSRj0oysjnndMGyBgYGxHaN6xF/FTIrb/AoGBsYJjLuGLZI7J4ngL9cxMDCOZPRCajXg9oY8yv1YDAyMrRnJ5vLVG++IvouBgbEp41lcyVPVAJqPl5UP1zAwMLZgVANlUqA2ByZaQbkMw8DAWJaRB9DqqEQvlayWshgYGOcwegVn9eAsD9PVMhgDAwOj2jCYB9DkneU+JwYGxpGMPEHMS+K80L0t4GJgYCzCyDeXhL/es8lPgIGBcSZjVDoGbcg8WawmhRgYGAcwvgAF44mH2rqMbQAAAABJRU5ErkJggg==">分享</a><div class="tags"><a href="/tags/源码/">源码</a><a href="/tags/Netty/">Netty</a></div><div class="post-nav"><a class="pre" href="/2017/04/01/Netty-ServerBootstrap/">Netty源码分析 ServerBootstrap服务端启动</a><a class="next" href="/2017/03/18/Netty-NioEventLoop/">Netty源码分析 I/O线程NioEventLoop</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=0.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=0.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=0.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '530c0141e83989b1dc02',
  clientSecret: '89e61ba0adc9b0c630bcc2641c791bfd7ef9faea',
  repo: 'kris-liu.github.io',
  owner: 'kris-liu',
  admin: ['kris-liu'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://blogxin.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Concurrent/">Concurrent</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/IO-NIO/">IO&NIO</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MQ/">MQ</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty/">Netty</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tools/">Tools</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构/">架构</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/线上问题/">线上问题</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/内存泄漏/" style="font-size: 15px;">内存泄漏</a> <a href="/tags/架构/" style="font-size: 15px;">架构</a> <a href="/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/tags/JVM/" style="font-size: 15px;">JVM</a> <a href="/tags/GC/" style="font-size: 15px;">GC</a> <a href="/tags/线上问题/" style="font-size: 15px;">线上问题</a> <a href="/tags/Git/" style="font-size: 15px;">Git</a> <a href="/tags/IO/" style="font-size: 15px;">IO</a> <a href="/tags/NIO/" style="font-size: 15px;">NIO</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/并发/" style="font-size: 15px;">并发</a> <a href="/tags/锁/" style="font-size: 15px;">锁</a> <a href="/tags/源码/" style="font-size: 15px;">源码</a> <a href="/tags/Transaction/" style="font-size: 15px;">Transaction</a> <a href="/tags/异步/" style="font-size: 15px;">异步</a> <a href="/tags/读写锁/" style="font-size: 15px;">读写锁</a> <a href="/tags/线程池/" style="font-size: 15px;">线程池</a> <a href="/tags/缓存/" style="font-size: 15px;">缓存</a> <a href="/tags/BIO/" style="font-size: 15px;">BIO</a> <a href="/tags/AIO/" style="font-size: 15px;">AIO</a> <a href="/tags/JMM/" style="font-size: 15px;">JMM</a> <a href="/tags/内存模型/" style="font-size: 15px;">内存模型</a> <a href="/tags/Netty/" style="font-size: 15px;">Netty</a> <a href="/tags/Tomcat/" style="font-size: 15px;">Tomcat</a> <a href="/tags/MQ/" style="font-size: 15px;">MQ</a> <a href="/tags/SpringBoot/" style="font-size: 15px;">SpringBoot</a> <a href="/tags/MyBatis/" style="font-size: 15px;">MyBatis</a> <a href="/tags/Tools/" style="font-size: 15px;">Tools</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/Distributed-Transaction-3/">从零开始写一个分布式事务框架(三)-事务记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/04/Distributed-Transaction-2/">从零开始写一个分布式事务框架(二)-架构</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/16/Distributed-Transaction-1/">从零开始写一个分布式事务框架(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/01/sharding-db/">基于Spring+MyBatis实现一个分库分表、读写分离功能的工具库</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/02/multi-datacenter/">多活架构思考总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/06/spring-boot-init/">SpringBoot启动流程解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/15/OOM-killer/">线上Java进程消失排查分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/09/30/Distributed-Consistency/">分布式系统数据一致性问题常见解决方案</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/11/kafka-block/">由一次kafka消费端消息阻塞问题分析kafka消费端线程模型</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/29/TransactionMessage/">事务消息实现原理</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://blog.csdn.net/xx_ytm" title="我的CSDN博客" target="_blank">我的CSDN博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">佑祺's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>